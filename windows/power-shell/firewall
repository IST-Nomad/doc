

Disable-NetFirewallRule
Enable-NetFirewallRule 
Get-NetFirewallProfile 
Get-NetFirewallRule 
Get-NetFirewallSetting - Retrieves the global firewall settings of the target computer. 
New-NetFirewallRule 
Remove-NetFirewallRule 
Rename-NetFirewallRule 
Set-NetFirewallProfile 
Set-NetFirewallRule 
Set-NetFirewallSetting 
Show-NetFirewallRule



//Отключить Defender
Set-NetFirewallProfile -Profile Domain, Public, Private -Enabled False

//добавим правила в сетевой экран Из под PowerShell (с правами администратора) для iperf3
New-NetFirewallRule -DisplayName 'iperf3' -Profile 'Any' -Direction Inbound -Action Allow -Protocol TCP -LocalPort 5201
New-NetFirewallRule -DisplayName 'iperf3' -Profile 'Any' -Direction Outbound -Action Allow -Protocol TCP -LocalPort 5201

//добавим правила в сетевой экран Из под PowerShell (с правами администратора) для iSCSI порт 860
New-NetFirewallRule -DisplayName 'iSCSI_860' -Profile 'Any' -Direction Inbound -Action Allow -Protocol TCP -LocalPort 860
New-NetFirewallRule -DisplayName 'iSCSI_860' -Profile 'Any' -Direction Outbound -Action Allow -Protocol TCP -LocalPort 860

//добавим правила в сетевой экран Из под PowerShell (с правами администратора) для iSCSI порт 3260
New-NetFirewallRule -DisplayName 'iSCSI_3260' -Profile 'Any' -Direction Inbound -Action Allow -Protocol TCP -LocalPort 3260
New-NetFirewallRule -DisplayName 'iSCSI_3260' -Profile 'Any' -Direction Outbound -Action Allow -Protocol TCP -LocalPort 3260


New-NetFirewallRule -DisplayName 'iSCSI_860' -Profile 'Any' -Direction Inbound -Action Allow -Protocol TCP -LocalPort 860

#Для входящего трафика (Inbound):
New-NetFirewallRule -DisplayName "Allow_Port_5222_TCP_Inbound" -Direction Inbound -LocalPort 5222 -Protocol TCP -Action Allow
#Для исходящего трафика (Outbound):
New-NetFirewallRule -DisplayName "Allow_Port_5222_TCP_Outbound" -Direction Outbound -LocalPort 5222 -Protocol TCP -Action Allow
#Чтобы убедиться, что правило добавлено, выполните команду:
Get-NetFirewallRule -DisplayName "Allow_Port_5222*"
#Если потребуется удалить правило, выполните команду:
Remove-NetFirewallRule -DisplayName "Allow_Port_5222_TCP_Inbound"



#Исключение для MSSQL
New-NetFirewallRule -DisplayName "Allow SQL Server TCP 1433" -Direction Inbound -Protocol TCP -LocalPort 1433 -Action Allow
New-NetFirewallRule -DisplayName "Allow SQL Server UDP 1434" -Direction Inbound -Protocol UDP -LocalPort 1434 -Action Allow

New-NetFirewallRule -DisplayName "Allow SQL Server TCP 1541" -Direction Inbound -Protocol TCP -LocalPort 1541 -Action Allow
New-NetFirewallRule -DisplayName "Allow SQL Server UDP 1434" -Direction Inbound -Protocol UDP -LocalPort 1434 -Action Allow

New-NetFirewallRule -DisplayName "GestBank_day TCP 30010" -Direction Inbound -Protocol TCP -LocalPort 30010 -Action Allow
New-NetFirewallRule -DisplayName "GestBank_day Server UDP 30010" -Direction Inbound -Protocol UDP -LocalPort 30010 -Action Allow

New-NetFirewallRule -DisplayName "GestBank TCP 30007" -Direction Inbound -Protocol TCP -LocalPort 30007 -Action Allow
New-NetFirewallRule -DisplayName "GestBank Server UDP 30007" -Direction Inbound -Protocol UDP -LocalPort 30007 -Action Allow

New-NetFirewallRule -DisplayName "EventManager TCP 5703" -Direction Inbound -Protocol TCP -LocalPort 5703 -Action Allow
New-NetFirewallRule -DisplayName "EventManager UDP 5703" -Direction Inbound -Protocol UDP -LocalPort 5703 -Action Allow

New-NetFirewallRule -DisplayName "WinAuthenticationServer TCP 5111" -Direction Inbound -Protocol TCP -LocalPort 5111 -Action Allow
New-NetFirewallRule -DisplayName "WinAuthenticationServer UDP 5111" -Direction Inbound -Protocol UDP -LocalPort 5111 -Action Allow

New-NetFirewallRule -DisplayName "FinistDigitalBank TCP 32801" -Direction Inbound -Protocol TCP -LocalPort 32801 -Action Allow
New-NetFirewallRule -DisplayName "FinistDigitalBank UDP 32801" -Direction Inbound -Protocol UDP -LocalPort 32801 -Action Allow

New-NetFirewallRule -DisplayName "FinistReport TCP 32802" -Direction Inbound -Protocol TCP -LocalPort 32802 -Action Allow
New-NetFirewallRule -DisplayName "FinistReport UDP 32802" -Direction Inbound -Protocol UDP -LocalPort 32802 -Action Allow

New-NetFirewallRule -DisplayName "LiteManager TCP 5650" -Direction Inbound -Protocol TCP -LocalPort 5650 -Action Allow
New-NetFirewallRule -DisplayName "LiteManager UDP 5650" -Direction Inbound -Protocol UDP -LocalPort 5650 -Action Allow

New-NetFirewallRule -DisplayName "Switchboard TCP 8080" -Direction Inbound -Protocol TCP -LocalPort 8080 -Action Allow
New-NetFirewallRule -DisplayName "Switchboard UDP 8080" -Direction Inbound -Protocol UDP -LocalPort 8080 -Action Allow

5222

New-NetFirewallRule -DisplayName "SendJabber TCP 5222" -Direction Inbound -Protocol TCP -LocalPort 5222 -Action Allow
New-NetFirewallRule -DisplayName "SendJabber UDP 5222" -Direction Inbound -Protocol UDP -LocalPort 5222 -Action Allow
New-NetFirewallRule -DisplayName "SendJabber TCP 5222" -Direction Outbound -Protocol TCP -LocalPort 5222 -Action Allow
New-NetFirewallRule -DisplayName "SendJabber UDP 5222" -Direction Outbound -Protocol UDP -LocalPort 5222 -Action Allow

New-NetFirewallRule -DisplayName "Finist_gateway_in TCP 8734" -Direction Inbound -Protocol TCP -LocalPort 8734 -Action Allow
New-NetFirewallRule -DisplayName "Finist_gateway_in UDP 8734" -Direction Inbound -Protocol UDP -LocalPort 8734 -Action Allow
New-NetFirewallRule -DisplayName "Finist_gateway_out TCP 8734" -Direction Outbound -Protocol TCP -LocalPort 8734 -Action Allow
New-NetFirewallRule -DisplayName "Finist_gateway_out UDP 8734" -Direction Outbound -Protocol UDP -LocalPort 8734 -Action Allow