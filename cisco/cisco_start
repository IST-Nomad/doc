
//Обнулить Cisco 
//подключиться через telnet и на старте загрузки нажать ctrl + Break должен выпать в rommon режим.
//запуск до конфигурации
confreg 0x2142 
//перезагрузка
reset 
enable
copy running-config startup-config
//устройство обнулено

//После изменения конфигурации необходимо вернуть обратно 
conft
config-register 0x2102
end
reload




//загрузка конфигурации на tftp сервер
copy startup-config tftp:
{10.129.135.110}

//настройка snmp на cisco
conf t
snmp-server community public ro
snmp-server contact Batr <poplavkovsemen@gmail.com>

//настройка порта для скачивания/загрузки ПО/конфигурации cisco
conf t
ip tftp source-interface {fastEthernet0/1}
ip tftp min-timeout 10

conf t
archive
//путь до tftp сервера, кладет в папку ATC (папка должна быть изначально создана) имя файла начинается с hostname ($h) и заканчивается временем создания
path tftp://10.129.135.110/ATC/$h 
//автоматическое архивирование при сохраниении конфигурации
write-memory

//настройка в режиме rommon для загрузки ПО c tftp сервера, нет истории команд и автозаполнения, лучше использовать терминальный клиент для копирования команд
IP_ADDRESS=10.129.139.249
IP_SUBNET_MASK=255.255.255.0
DEFAULT_GATEWAY=10.129.139.254
TFTP_SERVER=10.129.139.251
FE_PORT=0
TFTP_TIMEOUT=10000
TFTP_FILE=c890-universalk9-mz.154-3.M6a.bin
sync
tftpdnld -r

//команды rommon
dir flash:
boot flash:c890-universalk9-mz.154-3.M6a.bin


xmodem -y flash/c890-universalk9-mz.154-3.M6a.bin

reload in 1 //перезагрузка через минуту

//показывает список всех МАС адресов активных устройств, которые подключены к коммутатору
show mac address-table

//узнаем IP-адрес по каждому MAC-адресу
sh ip arp | i 0080.f0aa.39e3

//Для поиска MAC используется команда sh arp | inc x.x.x.x, где х.х.х.х – ip адрес интересующего хоста
sh arp | inc {192.168.10.100}

//фильтр по нужному МАС адресу, причем достаточно последних 4х символов
sh mac address-table | inc {74f2}

//Если в сети офиса их несколько, то определить имя и адрес управления нужного нам соседнего коммутатора помогут команды 
/*<!--Если cdp конечно включено--!>*/
sh cdp neighbors - покажется имена и связанные порты всех коммутаторов Cisco, подключенных к текущему и 
sh cdp neighbors detail - в выводе которой дополнительно указаны ip адреса для управления соседними коммутаторами


//Подключение AUX > console

//Настройка управляющего роутера
enable
conf t
line aux 0
speed 9600
databits 8
parity none
stopbits 1
exec-timeout 0 0
no activation-character
no editing
transport input telnet
transport output none

//Подключение 
//Узнать номер порта AUX
show line
//Если AUX висит на линии 1, тогда порт подключения: 2000 + 1 = 2001
telnet 10.5.0.1 2001
//где 10.5.0.1 - адрес внутреннего интерфейса роутера с которого идет подключение (управляющего)
//разорвать подключение
ctrl + shift + 6 и сразу нажимаем x
//смотрим активные подключения 
show session
//закрываем нужную
disconnect 1

// после удачной проверки можно сохранить подключение telnet 10.5.0.1 2001 | Это соедиеннеие не нужно разрывать, просто закрыть терминал

//Передача файлов через xmodem
copy (откуда) xmodem: (куда) flash:
//спросит имя файла, соответственно указать
как пойдет ожидание на прием (в зависимости от программы) включить передачу через xmodem

<<<<<<< Updated upstream
//Настройка интерфейса роутера
conf t
int fa 0/0
switchport access vlan 1
no shutdown
exit
int vlan 130
ip add 10.129.130.197 255.255.255.0
no shutdown
exit
int vlan 130
ip add 10.129.130.197 255.255.255.0
no shutdown


//Посмотреть изменения в конфигурации 
show archive config differences
//Показывает разницу между стартовой и текущей конфигурацией и кто и когда сделал изменение



show crypto isakmp policy
show crypto map
show crypto isakmp sa
show crypto isakmp sa detail
show crypto ipsec sa
show crypto engine connections active
sh crypto session


//Как настроить SSH на Cisco
Заходим в привилегированный режим;
enable
//Основные настройки делаются из режима конфигурирования терминала
conf t
//Задаем часовой пояс
clock timezone IRK 8
clock timezone YAKT 9
//Задаем часовой пояс
ntp server 10.129.135.110
ip domain-name krona-bank.ru
hostname cisco-ssh
crypto key generate rsa general-keys label HOSTNAME modulus 1024
ip ssh authentication-retries 5
ip ssh version 2
ip ssh time-out 60
no ip http server
no ip http secure-server
service password-encryption
username user privilege 15 secret Password
enable secret Password
aaa new-model
access-list 23 permit 192.168.0.0 0.0.0.255
line vty 0 4
transport input ssh
logging synchronous
privilege level 15
access-class 23 in
exit
exit
copy run start


configure terminal
logging 10.129.135.130
logging trap warning
//выбирая уровень включаются все снизу вверх начиная с выбранного

0 - emerg
1 - alert
2 - crit
3 - error
4 - warning
5 - notice
6 - informational
7 - debug

В Cisco есть такие фильтры (на примере show run):

include - покажет те строки конфигурации, в которых встречается регулярное выражение
exclude - покажет все строки конфигурации, кроме тех, где встречается регулярное выражение
begin - покажет строки, начиная со строки в которой встречается регулярное выражение
section (может не поддерживаться на коммутаторах) покажет раздел конфигурации, в названии которого встречается регулярное выражение