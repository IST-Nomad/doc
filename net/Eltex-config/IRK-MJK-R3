hostname IRK-MJK-R3

object-group service dns
  port-range 53
exit
object-group service ntp
  port-range 123
exit
object-group service ssh
  port-range 22
exit
object-group service TRACEROUTE
  port-range 33434-33529
exit
object-group service snmp
  port-range 161
exit
object-group service IPsec
  port-range 500
  port-range 4500
exit

object-group network ADMINPC
  description "LAN"
  ip address-range 10.129.10.1
  ip address-range 10.129.10.2
  ip address-range 10.129.10.3
exit

syslog max-files 3
syslog file-size 512
syslog file tmpsys:syslog/default
  severity info
exit

system config-confirm timeout 1200

no spanning-tree

security zone LAN
  description "LAN"
exit
security zone INET
  description "Internet"
exit

ip protocols ospf preference 110

router ospf 1
  router-id 10.136.136.3
  area 0.0.0.1
    network 10.129.136.0/24
    network 172.16.136.8/30
    enable
  exit
  enable
exit

interface gigabitethernet 1/0/2
  description "Inside-LAN"
  ip firewall disable
  ip address 10.129.136.251/24
  ip ospf instance 1
  ip ospf area 0.0.0.1
  ip ospf priority 1
  ip ospf
  vrrp id 1
  vrrp ip 10.129.136.254/32
  vrrp priority 110
  vrrp group 1
  vrrp preempt delay 5
  vrrp
exit
interface gigabitethernet 1/0/3
  shutdown
  mode switchport
exit
interface gigabitethernet 1/0/4
  shutdown
  mode switchport
exit
interface gigabitethernet 1/0/5
  shutdown
  mode switchport
exit
interface gigabitethernet 1/0/6
  shutdown
  mode switchport
exit
interface loopback 1
  ip address 10.129.30.14/32
  ip ospf instance 1
  ip ospf area 0.0.0.1
  ip ospf
exit

tunnel vti 1
  description "Eltex-IRK-HO-R3"
  mtu 1400
  ip firewall disable
  local address 91.185.48.3
  remote address 185.242.116.75
  ip address 172.16.136.10/30
  ip ospf instance 1
  ip ospf area 0.0.0.1
  ip ospf cost 1
  ip ospf network point-to-point
  ip ospf
  ip tcp adjust-mss 1360
  enable
exit
tunnel pppoe 1
  interface gigabitethernet 1/0/1
  mtu 1492
  ppp timeout keepalive 15
  ppp failure-count 15
  ip firewall disable
  ip tcp adjust-mss 1360
  username ppkronabank password ascii-text encrypted C8A10C7FB50446E8
  enable
exit

snmp-server
snmp-server community public v2c ro

snmp-server enable traps snmp
snmp-server enable traps snmp authentication
snmp-server enable traps snmp coldstart
snmp-server enable traps snmp linkdown
snmp-server enable traps snmp linkup

security zone-pair INET self
  rule 10
    description "VPN"
    action permit
    match protocol udp
    match destination-port object-group IPsec
    enable
  exit
  rule 20
    description "ospf"
    action permit
    match protocol ospf
    enable
  exit
  rule 30
    description "ESP"
    action permit
    match protocol esp
    enable
  exit
exit
security zone-pair LAN self
  rule 1
    description "SSH"
    action permit
    match protocol tcp
    match source-address object-group ADMINPC
    match destination-port object-group ssh
    enable
  exit
  rule 2
    description "ospf"
    action permit
    match protocol ospf
    enable
  exit
  rule 100
    description "ICMP"
    action permit
    match protocol icmp
    enable
  exit
  rule 110
    description "NTP"
    action permit
    match protocol udp
    match destination-port object-group ntp
    enable
  exit
exit
security zone-pair LAN INET
  rule 100
    description "ICMP"
    action permit
    match protocol icmp
    enable
  exit
  rule 101
    description "TRACEROUTE"
    action permit
    match protocol udp
    match destination-port object-group dns
    enable
  exit
exit

security ike proposal Eltex_ike_prop
  encryption algorithm aes128
  dh-group 14
exit

security ike policy Eltex_ike_pol
  pre-shared-key ascii-text encrypted 8EAF3D2485280CF4A56C9BAA3CC5F333D95BCAFBA19F0227
  proposal Eltex_ike_prop
exit

security ike gateway IRK_HO_R3
  ike-policy Eltex_ike_pol
  mode route-based
  mobike disable
  bind-interface vti 1
exit

security ipsec proposal Eltex_ipsec_prop
  encryption algorithm aes128
exit

security ipsec policy Eltex_ipsec_pol
  proposal Eltex_ipsec_prop
exit

security ipsec vpn IRK_HO_R3_IPSEC
  ike establish-tunnel route
  ike gateway IRK_HO_R3
  ike ipsec-policy Eltex_ipsec_pol
  enable
exit

ip firewall sessions allow-unknown

ip route 185.242.116.74/32 91.185.48.2
ip route 185.242.116.75/32 91.185.48.2
ip route 195.206.62.4/32 91.185.48.2
ip route 195.206.62.5/32 91.185.48.2

ip ssh server
ip ssh authentication algorithm md5 disable
ip ssh authentication algorithm md5-96 disable
ip ssh authentication algorithm ripemd160 disable
ip ssh authentication algorithm sha1 disable
ip ssh authentication algorithm sha1-96 disable
ip ssh authentication algorithm sha2-256 disable
ip ssh encryption algorithm 3des disable
ip ssh encryption algorithm aes128 disable
ip ssh encryption algorithm aes128ctr disable
ip ssh encryption algorithm aes192 disable
ip ssh encryption algorithm aes192ctr disable
ip ssh encryption algorithm aes256 disable
ip ssh encryption algorithm arcfour disable
ip ssh encryption algorithm arcfour128 disable
ip ssh encryption algorithm arcfour256 disable
ip ssh encryption algorithm blowfish disable
ip ssh encryption algorithm cast128 disable
ip ssh key-exchange algorithm dh-group-exchange-sha1 disable
ip ssh key-exchange algorithm dh-group1-sha1 disable
ip ssh key-exchange algorithm dh-group14-sha1 disable
ip ssh key-exchange algorithm ecdh-sha2-nistp256 disable
ip ssh key-exchange algorithm ecdh-sha2-nistp384 disable
ip ssh key-exchange algorithm ecdh-sha2-nistp521 disable
ip ssh host-key algorithm dsa disable
ip ssh host-key algorithm ecdsa256 disable
ip ssh host-key algorithm ecdsa384 disable
ip ssh host-key algorithm ecdsa521 disable
ip ssh host-key algorithm ed25519 disable

archive
  path tftp://10.129.135.110:/IRK-MGK-R3/Eltex-IRK-MGK-R3
  auto
  by-commit
exit

clock timezone gmt +8

ntp enable
ntp server 10.129.135.110
exit
